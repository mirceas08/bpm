% n ... primal dim
% k ... nullity of Z (multiplicity of lambda_max(-Z))
%   equivalently, since strict complementarity holds, rank of X
% m ... number of primal constraints
% A m by n*n; each row is vec( sym matrix)

n = 2;
k = 1;
m = 2;

myLength = 2;
A_temp = [];
for i=1:myLength
	[A, b, C, X, y, Z] = make_sdp(n, k, m);	

	dim(i) = size(C,1);
	
	A_GT = A';
	A_temp(i,:) = full(A(:))';
	
	filenameA = strcat('/home/mircea/Desktop/Mircea/SoHPC/bpm/bpm_read/A_GT', num2str(i), '.dat');
	save(filenameA, 'A_GT', '-ascii');
	filenameC = strcat('/home/mircea/Desktop/Mircea/SoHPC/bpm/bpm_read/C', num2str(i), '.dat');
	save(filenameC, 'C', '-ascii');	

	data.A_GT{i} = A_GT;
	data.b = b;
	data.C{i} = C;
	data.dim(i) = dim(i);
end

AAT = A_temp * A_temp';
save('/home/mircea/Desktop/Mircea/SoHPC/bpm/bpm_read/AAT.dat', 'AAT', '-ascii');
save('/home/mircea/Desktop/Mircea/SoHPC/bpm/bpm_read/b.dat', 'b', '-ascii');
save('/home/mircea/Desktop/Mircea/SoHPC/bpm/bpm_read/dim.dat', 'dim', '-ascii');

disp('starting...');
[X,y,Z,sigma] = bpm_block(data);
